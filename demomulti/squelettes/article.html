<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<BOUCLE_art0(ARTICLES){id_article}>
<BOUCLE_hier0(HIERARCHIE){id_article}{1,1}>
<BOUCLE_mots0(MOTS){id_rubrique}{type=Chapitres}>
<BOUCLE_lang0(RUBRIQUES){tout}{id_mot}{id_secteur!=7}{lang}>
[(#REM) <!-- Explication de cette série de boucles :
- La première boucle prend tout simplement l’article passé dans l’URL. Grâce à la syntaxe
#_art0:TITRE, #_art0:LANG_DIR, etc. il est possible, à travers la page, d’accéder à toutes les balises de l’article;
- La deuxième boucle cherche la rubrique au niveau «chapitre» (le niveau immédiatement en dessous du niveau racine)
qui doit être marquée d’un des mots-clés « Chapitres »;
- C’est l'identité de ce mot que nous cherchons avec la troisième boucle: alors nous savons en quel «chapitre» nous nous trouvons;
- Et la 4ème boucle prend d’abord la langue {lang} -- qui sera soit la langue passée dans l’URL
(forcer_lang étant donc activé), soit, s’il n’y en avait pas, la langue de l’article. Ensuite la boucle exclut le secteur 7
(c’est l’ID du secteur « partagé » qui ne va pas changer). Enfin il cherche la rubrique qui est dans la bonne langue
et qui porte le mot-clé du chapitre. Cette dernière boucle donne la langue en cours pour les deux menus, et pour les
chaînes <: xxx :> --> ]

<html lang="#LANG">
<head>
<title>[(#TITRE|textebrut)]</title>
<meta http-equiv="Content-Type" content="text/html; charset=#CHARSET">
<style type="text/css">
<!--
td {vertical-align: top}
.spip_documents {margin-bottom: 15px}
-->
</style>
</head>
<body bgcolor="white" dir="#LANG_DIR">
<table>
<tr>
<td colspan="3">

<p><a href="#URL_SITE_SPIP"><:accueil_site:></a></p>

<!-- Début sélecteur de langues -->
[(#REM) <!-- On commence le formulaire à l'intérieur des boucles, car si un article n'a aucune traduction, le sélecteur
	de langues ne se montre pas. --> ]
<BOUCLE_check7(ARTICLES){traduction}{id_secteur=7}>
<B_langs1>
[(#REM)<!-- Une traduction de cet article se trouve dans le secteur partagé. -->]
<form id="langselect" action="#URL_SITE_SPIP/" method="get">
<select size="1" name="langs" onChange="if (options[selectedIndex].value){location = options[selectedIndex].value; }">
[(#REM) <!-- Afficher la langue en cours. --> ]
<option selected value="">[(#_lang0:LANG|traduire_nom_langue)]</option>
<BOUCLE_langs1(RUBRIQUES){racine}{id_rubrique != 7}{lang != #_lang0:LANG}}{par lang}>
[(#REM)<!-- Chercher les langues, en excluant la langue en cours. -->]
<BOUCLE_cacher(MOTS){type=Cacher}{titre=#LANG}{id_article}>
[(#REM)<!-- Hide this article for this language -->]
</BOUCLE_cacher>
<BOUCLE_checktrad1(ARTICLES){traduction}{id_secteur}{exclus}>
[(#REM)<!-- Check if there's a real translation of the article in this language -->]
<option value="#URL_ARTICLE">[(#LANG|traduire_nom_langue)]</option>
</BOUCLE_checktrad1>
<BOUCLE_checklang(ARTICLES){id_article}{!lang_select}{lang=#_langs1:LANG}>
[(#REM)<!-- If not, point to shared article. If language of shared article (usually English) is the same as the current language, there's no need for a ?lang=xx in the URL -->]
<option value="[(#URL_ARTICLE|parametre_url{lang,''}|parametre_url{id_document}|parametre_url{debut_page})]">[(#LANG|traduire_nom_langue)]</option>
</BOUCLE_checklang>
[(#REM)<!-- ?lang=xx is needed in the URL -->]
<option value="[(#URL_ARTICLE|parametre_url{lang,#LANG}|parametre_url{id_document}|parametre_url{debut_page})]">[(#LANG|traduire_nom_langue)]</option>
<//B_checklang>
<//B_checktrad1>
<//B_cacher>
</BOUCLE_langs1>
</select>
</form>
</B_langs1>
</BOUCLE_check7>
<B_trads1>
[(#REM)<!-- Article does not have a shared translation -->]
<form id="langselect" action="#URL_SITE_SPIP/" method="get">
<select size="1" name="langs" onChange="if (options[selectedIndex].value){location = options[selectedIndex].value; }">
<option selected value="">[(#LANG|traduire_nom_langue)]</option>
<BOUCLE_trads1(ARTICLES){traduction}{exclus}{par lang}>
<option value="#URL_ARTICLE">[(#LANG|traduire_nom_langue)]</option>
</BOUCLE_trads1>
</select>
</form>
</B_trads1>
<//B_check7>
</td></tr>
<!-- Fin sélecteur de langues -->

<!-- Début menu -->
<tr><td width="33%">
<br>
<BOUCLE_chaps(RUBRIQUES){type_mot=Chapitres}{lang}{id_secteur != 7}{tout}>
<strong><a href="#URL_RUBRIQUE">[(#TITRE|supprimer_numero)]</a></strong>
<BOUCLE_mots2(MOTS){id_rubrique}{type=Chapitres}>

[(#REM)<!-- !lang_select so that <multi>s work in article titles -->]

<BOUCLE_sharedchap(RUBRIQUES){id_secteur=7}{id_mot}{tout}{!lang_select}>
	<B_toplevelarticles>
		<ul>
[(#REM)<!-- !lang_select so that <multi>s work in article titles -->]
	<BOUCLE_toplevelarticles(ARTICLES){id_rubrique IN #_sharedchap:ID_RUBRIQUE, #_chaps:ID_RUBRIQUE}{par titre}{!lang_select}>
<!-- check if it's a shared article -->
<BOUCLE_checksect1(ARTICLES){id_secteur=7}{id_article}{!lang_select}>
<BOUCLE_trads2(ARTICLES){traduction}{exclus}{lang = #_chaps:LANG}>
[(#REM) <!-- Check that a translation in the current language does not exist, -->]
</BOUCLE_trads2>
<BOUCLE_cacher1(MOTS){type=Cacher}{titre=#_chaps:LANG}{id_article}>
[(#REM) <!-- and that it hasn't been marked with a "hide" keyword. -->]
</BOUCLE_cacher1>
<li>[<a (#EXPOSE{'',href})="[(#LANG|=={#_chaps:LANG}|?{[(#URL_ARTICLE)],[(#URL_ARTICLE|parametre_url{lang,[(#_chaps:LANG)]})]})]">][(#TITRE|supprimer_numero)][(#EXPOSE{'',</a>})]</li>
<//B_cacher1>
<//B_trads2>
</BOUCLE_checksect1>
[(#REM) <!-- The article is a native one -->]
<li>[<a (#EXPOSE{'',href})="#URL_ARTICLE">][(#TITRE|supprimer_numero)][(#EXPOSE{'',</a>})]</li>

<//B_checksect1>

	</BOUCLE_toplevelarticles>
		</ul>
	</B_toplevelarticles>

</BOUCLE_sharedchap>
</BOUCLE_mots2>
</BOUCLE_chaps>
<!-- Fin menu -->
</td>

<td width="5%">&nbsp;</td>

<td width="60%" dir="#_art0:LANG_DIR">
<h2>[(#_art0:TITRE|supprimer_numero)]</h2>
[<div>(#_art0:CHAPO)</div>]
[<div>(#_art0:TEXTE)</div>]
</td>
<td width="2%">&nbsp;</td>
</tr></table>
</body>
</html>
</BOUCLE_lang0>
</BOUCLE_mots0>
</BOUCLE_hier0>
</BOUCLE_art0>
(<:no_article_here:>)
<//B_art0>