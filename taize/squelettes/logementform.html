<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<BOUCLE_art0(ARTICLES){id_article}>
	<BOUCLE_hier0(HIERARCHIE){id_article}{1,1}>
		<BOUCLE_mots0(MOTS){id_rubrique}{type=SectionLogo}>
			<BOUCLE_lang0(RUBRIQUES){tout}{id_mot}{id_secteur!=586}{lang}>
<html lang="#LANG">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Taiz&eacute; - [(#_art0:TITRE|supprimer_numero|supprimer_tags)]</title>
<link rel="stylesheet" type="text/css" href="#DOSSIER_SQUELETTE/t_main.css">
<link rel="stylesheet" type="text/css" href="#DOSSIER_SQUELETTE/t_forms.css">
<style type="text/css">
<!--
#hmenu ul li {float: left; border-right: 1px solid #990000}
-->
</style>
<script type="text/javascript" src = "ext/common.js"></script>

<script language="JavaScript"> var _version = 1.0; </script>
<script language="JavaScript1.2"> _version = 1.2; </script>
<script language="JavaScript">
<!--
if (_version < 1.2)
{
  var strBrowserMsg = "Para preencher esta ficha precisa de um Browser com JavaScript 1.2 ou mais recente.\n\n";
  strBrowserMsg += "Também pode enviar a sua oferta de alojamento ao seguinte endereço e-mail: alojamento@taize-lx.net";
  location.href = "http://www.taize.fr/pt";
  alert(strBrowserMsg);
}

function ValidateMe(theForm) {
var strRequired;
var strNumOnly;
var strIncompatible;
var strEmail;
var intTemp;

strRequired = "Esta ficha ainda não completa. Por favor preencha os campos que faltam!";
strNumOnly = "Por favor entre um número neste campo (que pode ser zero).";
strIncompatible ="Os seus dados não estão claros!";
strEmail = "Endereço e-mail inválido.";


 theForm.FirstName.value = TrimStr(theForm.FirstName.value)
  if (theForm.FirstName.value == "") {
    alert(strRequired);
    theForm.FirstName.focus();
    return (false);
  }

  theForm.FamilyName.value = TrimStr(theForm.FamilyName.value)
  if (theForm.FamilyName.value == "") {
    alert(strRequired);
    theForm.FamilyName.focus();
    return (false);
  }

  theForm.Address.value = TrimStr(theForm.Address.value)
  if (theForm.Address.value == "") {
    alert(strRequired);
    theForm.Address.focus();
    return (false);
  }

  if (RequiredDigits(theForm.Postcode.value) == false) {
    alert(strNumOnly);
    theForm.Postcode.focus();
    return (false);
  }
  if (theForm.Postcode.value.length < 4) {
      alert("O código postal não está correcto!");
      theForm.Postcode.focus();
      return (false);
    }

  var checkstart=/(^2)|(^1)/;
  if(theForm.Postcode.value.search(checkstart) == -1){
    alert("Só é possível preencher esta ficha com códigos postais pretencentes à região de acolhimento do Encontro de Lisboa!");
    theForm.Postcode.focus();
    return (false);
  }

  theForm.Town.value = TrimStr(theForm.Town.value)
  if (theForm.Town.value == "") {
    alert(strRequired);
    theForm.Town.focus();
    return (false);
  }

/*
 * theForm.Tel.value = TrimStr(theForm.Tel.value)
 * if (theForm.Tel.value == "") {
 *   alert(strRequired);
 *   theForm.Tel.focus();
 *   return (false);
 * }
 */

  if (CheckEmailFormat(theForm.Email.value) == false) {
       alert(strEmail);
       theForm.Email.focus();
       return (false);
  }

// check there are numbers in all boxes

 if (RequiredDigits(theForm.acctotal.value) == false) {
    alert(strNumOnly);
    theForm.acctotal.focus();
    return (false);
  }

 if (RequiredDigits(theForm.floortotal.value) == false) {
    alert(strNumOnly);
    theForm.floortotal.focus();
    return (false);
  }

 if (RequiredDigits(theForm.flooreither.value) == false) {
    alert(strNumOnly);
    theForm.flooreither.focus();
    return (false);
  }

 if (RequiredDigits(theForm.floorgirls.value) == false) {
    alert(strNumOnly);
    theForm.floorgirls.focus();
    return (false);
  }

 if (RequiredDigits(theForm.floorboys.value) == false) {
    alert(strNumOnly);
    theForm.floorboys.focus();
    return (false);
  }

 if (RequiredDigits(theForm.bedtotal.value) == false) {
    alert(strNumOnly);
    theForm.bedtotal.focus();
    return (false);
  }

 if (RequiredDigits(theForm.bedeither.value) == false) {
    alert(strNumOnly);
    theForm.bedeither.focus();
    return (false);
  }

 if (RequiredDigits(theForm.bedwoman.value) == false) {
    alert(strNumOnly);
    theForm.bedwoman.focus();
    return (false);
  }

 if (RequiredDigits(theForm.bedman.value) == false) {
    alert(strNumOnly);
    theForm.bedman.focus();
    return (false);
  }

 if (RequiredDigits(theForm.couple.value) == false) {
    alert(strNumOnly);
    theForm.couple.focus();
    return (false);
  }

 if (RequiredDigits(theForm.family.value) == false) {
    alert(strNumOnly);
    theForm.family.focus();
    return (false);
  }

 if (RequiredDigits(theForm.disabled.value) == false) {
    alert(strNumOnly);
    theForm.disabled.focus();
    return (false);
  }

 if (RequiredDigits(theForm.family.value) == false) {
    alert(strNumOnly);
    theForm.family.focus();
    return (false);
  }

 if (RequiredDigits(theForm.disabled.value) == false) {
    alert(strNumOnly);
    theForm.disabled.focus();
    return (false);
  }

 if (RequiredDigits(theForm.extralunch.value) == false) {
    alert(strNumOnly);
    theForm.extralunch.focus();
    return (false);
  }

 if (RequiredDigits(theForm.lunchonly.value) == false) {
    alert(strNumOnly);
    theForm.lunchonly.focus();
    return (false);
  }

// Check for incompatibilities

 if (parseInt(theForm.floortotal.value) != parseInt(theForm.flooreither.value) + parseInt(theForm.floorgirls.value) + parseInt(theForm.floorboys.value)) {
   alert(strIncompatible);
   theForm.floortotal.focus();
   return (false);
 }

 if (parseInt(theForm.bedtotal.value) != parseInt(theForm.bedeither.value) + parseInt(theForm.bedwoman.value) + parseInt(theForm.bedman.value) + (parseInt(theForm.couple.value) * 2) + (parseInt(theForm.family.value) * 4) + (parseInt(theForm.disabled.value) * 2)) {
   alert(strIncompatible);
   theForm.bedtotal.focus();
   return (false);
 }

 if (parseInt(theForm.acctotal.value) != (parseInt(theForm.floortotal.value) + parseInt(theForm.bedtotal.value))) {
   alert(strIncompatible);
   theForm.acctotal.focus();
   return (false);
 }

if ((parseInt(theForm.acctotal.value) > 0) && (parseInt(theForm.lunchonly.value) > 0 )) {
  alert(strIncompatible);
  theForm.lunchonly.focus();
  return (false);
}

if ((parseInt(theForm.extralunch.value) > 0) && (parseInt(theForm.lunchonly.value) > 0 )) {
  alert(strIncompatible);
  theForm.lunchonly.focus();
  return (false);
}

if ((parseInt(theForm.acctotal.value) == 0) && (parseInt(theForm.lunchonly.value) == 0 )) {
  alert("Não pode enviar uma ficha que não esteja preenchida!");
  theForm.acctotal.focus();
  return (false);
}

// ---- End of validation

// ================== Now fill the hidden, composite fields

  var s;

// subject line
  s = theForm.elements["Postcode"].value + " " + theForm.elements["Town"].value.toUpperCase() + "  [" + theForm.Parish.options[theForm.Parish.selectedIndex].value + "]";
  if (parseInt(theForm.elements["acctotal"].value) > 0) {
    s = s +  "  Alojamento para " + theForm.elements["acctotal"].value + " pessoas.";
    }
  else {
    s = s +  " Acolhe apenas " + theForm.elements["lunchonly"].value + "pessoas para o almoco de 1 de Janeiro.";
    }

    theForm.elements["_subject"].value = s;

// parish line

    theForm.elements["_parish"].value = "Paróquia: " + theForm.Parish.options[theForm.Parish.selectedIndex].value + "\n\n";

// name and contact info (\n makes an empty line)

if (theForm.elements["Postcode2"].value > "") {
	theForm.elements["Postcode"].value = theForm.elements["Postcode"].value + "-" + theForm.elements["Postcode2"].value;
}
  	     s = "Nome:     " + theForm.elements["FirstName"].value + "\n";
	 s = s + "Apelido:  " + theForm.elements["FamilyName"].value + "\n";
     s = s + "Morada:   " + theForm.elements["Address"].value + ", " + theForm.elements["Postcode"].value + " " + theForm.elements["Town"].value + "\n";
     s = s + "Telefone: " + theForm.elements["Tel"].value + "\n";
     s = s + "Telemóvel: " + theForm.elements["Mobile"].value + "\n";
          s = s + "E-mail:   " + theForm.elements["Email"].value;

    if (theForm.elements["Comments"].value !="") {
  	  s = s + "\n\nComentários: " + theForm.elements["Comments"].value;
    }
    theForm.elements["_contactinfo"].value = s;


  s = ""
  if (parseInt(theForm.elements["acctotal"].value) > 0) {
    s = "Total de pessoas alojadas: " + theForm.elements["acctotal"].value + "\n\n";
    if (parseInt(theForm.elements["floortotal"].value) > 0) {
      s = s + "No chão: " + theForm.elements["flooreither"].value + " rapaze(s) OU rapariga(s) + " + theForm.elements["floorgirls"].value + " rapariga(s) + " + theForm.elements["floorboys"].value + " rapaz(es)\n\n";
    }
    if (parseInt(theForm.elements["bedtotal"].value) > 0) {
      s = s + "Em camas: " + theForm.elements["bedeither"].value + " mulhere(s) OU homem(homens) +   " + theForm.elements["bedwoman"].value + " mulhere(s) +   " + theForm.elements["bedman"].value + " homem(homens)\n    + " + theForm.elements["couple"].value + " casal(casais) + " + theForm.elements["family"].value + " família(s) + " + theForm.elements["disabled"].value + " pessoa(s) com deficiência\n\n";
    }

if (theForm.lunch[1].checked) {
      s = s + "Não posso receber as pessoas que acolho para o almoço de dia 1 de Janeiro!\n\n";
    }


    if (parseInt(theForm.elements["extralunch"].value) > 0) {
      s = s + "Para além das que acolho, posso receber mais " + theForm.elements["extralunch"].value +" pessoas para o almoço de dia 1 de Janeiro.\n\n";
    }
  }
  else {
     s = "Não posso acolher ninguém, mas posso receber " + theForm.elements["lunchonly"].value + " pessoas para o almoço de dia 1 de Janeiro.\n\n";
  }
  theForm.elements["_offer"].value = s;


// All fields prepared; Ask for confirmation
  var msg;
  if (parseInt(theForm.elements["acctotal"].value) > 0) {
    msg = "Por favor confirme que pode acolher " + theForm.elements["acctotal"].value + " pessoas de 28 de Dezembro a 1 de Janeiro.\n\nSe os dados não estiverem correctos clique em cancelar.";
  }
  else {
    msg = "Por favor confirme que pode receber " + theForm.elements["lunchonly"].value + " pessoas para o almoço de dia 1 de Janeiro.\n\nSe os dados não estiverem correctos clique em cancelar.";
  }

  if (confirm(msg)) {
    return (true);
  }
  else {
	alert("A sua ficha de acolhimento não foi enviada.");
    return (false);
  }
}
//-->
</script>
</head>
<body dir="#LANG_DIR">
#DEBUT_SURLIGNE
#FIN_SURLIGNE
<table id="header2" class="header2" align="center" cellpadding="0" cellspacing="0">
<tr><td height="3" colspan="4"></td></tr>
<!-- Header row -->
<tr>
<td width="5"></td>
<td align="left" valign="top">
<a href="#URL_SITE_SPIP/"><img src="IMG/taize.gif" alt="<:home:>" title="<:home:>" width="15" height="10" border="0"></a>&nbsp;
<a href="#URL_SITE_SPIP/#LANG"><img src="IMG/home.gif" title="[(#LANG|traduire_nom_langue)]" alt="[(#LANG|traduire_nom_langue)]" height="8" width="15" border="0"></a>
<a name="pagetop"></a>
</td>
<td align="right" valign="top">
&nbsp;
</td>
<td width="5">
</td>
<tr>
<td width="5">
</td>
<td align="left" valign="bottom">
<!-- Language selector: not needed for this page -->
</td>
<td align="right" valign="bottom"  id="formrecherche">
<!-- Search box -->
<INCLURE(ti_searchbox.php3){lang}>
</td>
<td width="5">
</td>
</tr>
<tr height="5">
<td colspan="4"></td>
</tr>
</table>
<table width="760" align="center" cellpadding="0" cellspacing="0">
<!-- Row with horizontal menu -->
<tr valign="top">
<td align="left" valign="top">
<INCLURE(ti_hmenu.php3){id_rubrique}>
</td>
</tr>
<!-- Spacing row below horizontal menu -->
<tr>
<td align="left" valign="top">&nbsp;
</td>
</tr>
</table>
<table width="760" id="main" align="center" cellpadding="0" cellspacing="0">
<tr>
<!-- Left page-margin -->
<td width="5">&nbsp;</td>
<!-- Left nav column -->
<td width="170" valign="top">
<img border="0" src="./ext/eur/lb_ptgr.gif">
<div id="vmenu">
<INCLURE(ti_vmenu.php3){id_article}{id_rubrique}{id_mot}{lang}>
</div>
</td>
<!-- Margin between left-nav and content -->
    <td width="25">&nbsp;</td>
<!-- Content -->
<td width="375" valign="top">
	 [<div class="surtitre">(#SURTITRE)</div>]
	 [<div class="surtitre">(#SOUSTITRE)</div>]
     <h1 class="titre-texte">[(#_art0:TITRE|supprimer_numero)]</h1>
     [<div class="chapeau">(#CHAPO)</div>]
     [<div class="texte">(#_art0:TEXTE|liens_ouvrants|autoriser_php)</div>]
     [<div class="notes">(#NOTES)</div>]
     [<div class="ps">(#PS)</div>]</td>
<!-- Margin between content and right-nav -->
<td width="20">&nbsp;</td>
<!-- Right-nav -->
<td width="160" valign="top">
[<table class="cadre" cellspacing="0" cellpadding="0" dir="#_art0:LANG_DIR">
<tr><td class="r-hleft"></td>
<td class="r-h">
</td>
<td class="r-hright"></td></tr>
<tr><td class="r-left"></td>
<td class="r-c">
<div class="spot">(#PS|autoriser_php|antispam)</div>
</td>
<td class="r-right"></td></tr>
<tr><td class="r-bleft"></td>
<td class="r-b"></td>
<td class="r-bright"></td></tr>
<tr><td>
</td></tr>
</table>]
<BOUCLE_motsnews(MOTS){type=News}{id_article}>
<BOUCLE_news(BREVES){id_mot}{lang}>
<br>
<table class='cadre' cellspacing='0' cellpadding='0'>
<tr><td class='r-hg'></td>
<td class='r-h'>
</td>
<td class='r-hd'></td></tr>
<tr><td class='r-g'></td>
<td class='r-c'><span class='newstitle'>#TITRE</span><br>
<div class='news'>#TEXTE</div>
</td>
<td class='r-d'></td></tr>
<tr><td class='r-bg'></td>
<td class='r-b'></td>
<td class='r-bd'></td></tr>
<tr><td>
</td></tr>
</table>
</BOUCLE_news>
</BOUCLE_motsnews>

<!-- See also list -->
<B_pointers>
<!-- Pointers (one-way) -->
<div id="seealso">
<:see_also:>
<ul>
<BOUCLE_pointers(MOTS){type=Pointers}{id_article}>
<BOUCLE_pointedto(MOTS){type=PointedTo}{titre=#TITRE}>
<BOUCLE_seealso(ARTICLES){id_mot}{id_secteur IN #ID_SECTEUR, 586}{par titre}{!lang_select}>
<BOUCLE_checksect(ARTICLES){id_secteur=586}{id_article}{!lang_select}>
<BOUCLE_trads(ARTICLES){traduction}{exclus}{lang = #_lang0:LANG}>
</BOUCLE_trads>
<BOUCLE_hide(MOTS){type=Hide}{titre=#_lang0:LANG}{id_article}>
</BOUCLE_hide>
<BOUCLE_checklang1(ARTICLES){id_article}{!lang_select}{lang=#_lang0:LANG}>
<li><a href="#URL_ARTICLE">[(#SURTITRE): ][(#TITRE|supprimer_numero)]</a></li>
</BOUCLE_checklang1>
<li><a href="#URL_ARTICLE?lang=#_principale:LANG">[(#SURTITRE): ][(#TITRE|supprimer_numero)]</a></li>
<//B_checklang1>
<//B_hide>
<//B_trads>
</BOUCLE_checksect>
<li><a href="#URL_ARTICLE">[(#SURTITRE): ][(#TITRE|supprimer_numero)]</a></li>
<//B_checksect>
</BOUCLE_seealso>
</BOUCLE_pointedto>
</BOUCLE_pointers>
<!-- Themes (bidirectional; only native articles) -->
<BOUCLE_themes1(MOTS){type=Theme}{id_article}>
<BOUCLE_related1(ARTICLES){id_mot}{id_secteur}{exclus}{par titre}>
<li><a href=#URL_ARTICLE>[(#SURTITRE): ][(#TITRE|supprimer_numero)]</a></li>
</BOUCLE_related1>
</B_related1>
</BOUCLE_themes1>
</ul>
</div>
</B_pointers>
<B_themes2>
<!-- There aren't any pointers, so just show themes -->
<div id="seealso">
<BOUCLE_themes2(MOTS){type=Theme}{id_article}>
<B_related2>
<:see_also:>
<ul>
<BOUCLE_related2(ARTICLES){id_mot}{id_secteur}{exclus}{par titre}>
<li><a href=#URL_ARTICLE>[(#SURTITRE): ][(#TITRE|supprimer_numero)]</a></li>
</BOUCLE_related2>
</ul>
</B_related2>
</BOUCLE_themes2>
</div>
</B_themes2>
<//B_pointers>
</td>
<!-- Right page-margin -->
<td width="5">&nbsp;</td></tr></table>
<!-- Footer -->
<table width="760" align="center" cellpadding="0" cellspacing="0">
<tr><td>&nbsp;</td></tr>
<tr><td>
<INCLURE(ti_footer.php3){lang}>
</td></tr>
</table>
</body>
</html>
			</BOUCLE_lang0>
		</BOUCLE_mots0>
	</BOUCLE_hier0>
</BOUCLE_art0>
(<:no_article_here:>)
<//B_art0>
