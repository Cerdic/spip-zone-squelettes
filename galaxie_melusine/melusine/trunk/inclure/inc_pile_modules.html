[(#REM)

	Gestion générique des piles de modules (noisettes) pour
	les blocs

	L'appel du module prend un paramètre obligatoire:
		bloc: nom du bloc dans lequel on veut gérer les modules

	optionnel:
		type: type de page, s'il est absent le type de page est "rubrique"




]
#SET{type_par_defaut,rubrique}
[(#SET{admin_melusine,[(#SESSION{statut}
			|=={0minirezo}
			|oui)
		oui]}
)]
[(#SET{nom_bloc,[(#BLOC|melusine_nombloc) ([(#TYPE)])]})]

[(#REM)

	On vérifie qu'il reste de la place libre pourr afficher
	le bouton d'ajout, ou non

]

<BOUCLE_Place_libre(NOISETTES)
			{type=#ENV{type,#GET{type_par_defaut}}}
			{bloc}
			{11,1}
			{si #GET{admin_melusine}|oui}>
<span class="info">Ce bloc est plein</span>
</BOUCLE_Place_libre>
[(#GET{admin_melusine}|oui)
<a href="[(#URL_PAGE{ajout_module_bloc,bloc=#BLOC}
		|parametre_url{'type',#TYPE}
		|parametre_url{'nom_bloc',#GET{nom_bloc} }
	)]" class='ajout_module button mediabox boxIframe boxWidth-500px boxHeight-90%'>
	<i class="fa fa-plus-circle fa-x2"></i> Ajouter un module ici
</a> ]
<//B_Place_libre>



[(#ENV{ajout}>{0}|et{#GET{admin_melusine}}|oui)  
 <a href="[(#URL_PAGE{ajout_module_bloc,bloc=#ENV{ajout}}
		|parametre_url{'type',#TYPE}
		|parametre_url{'nom_bloc',#GET{nom_bloc}}
	)]" class='ajout_module button mediabox boxIframe boxWidth-500px boxHeight-90%'>
	<i class="fa fa-plus-square fa-x2 fa-space"></i> Ajouter une colonne
</a>]



<BOUCLE_modules(NOISETTES){type=#ENV{type,#GET{type_par_defaut}}}{bloc}{par rang}>
<div class="module_melusine[(#GET{admin_melusine}|oui) admin_melusine][ (#ENV{id_noisette}|=={#ID_NOISETTE}|oui)on]">
[(#GET{admin_melusine}|oui)
	#FORMULAIRE_MELUSINE_DEPLACER_MODULE{#ID_NOISETTE}
]

	[(#SET{fond,[(#NOISETTE|strrpos{"/"}|?{"","noisettes/"}|concat{#NOISETTE})]})]
	
		<INCLURE{fond=#GET{fond},env}{id_noisette=#ID_NOISETTE}>
	
</div>
</BOUCLE_modules>
#FILTRE{trim}